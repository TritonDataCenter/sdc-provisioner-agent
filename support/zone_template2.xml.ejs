<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE zone PUBLIC "-//Sun Microsystems Inc//DTD Zones//EN" "file:///usr/share/lib/xml/dtd/zonecfg.dtd.1">

<zone name="<%= zonename %>" zonepath="<%= zpool_path %>/<%= zonename %>" autoboot="true" brand="joyent" limitpriv="default,dtrace_proc,dtrace_user" ip-type="exclusive">

  <% for (var i=0; i < inherited_directories.length; i++) { %>
  <filesystem special="<%= inherited_directories[i] %>" directory="<%= inherited_directories[i] %>" type="lofs">
    <fsoption name="ro"/>
  </filesystem>
  <% } %>

  <rctl name="zone.cpu-shares">
    <rctl-value priv="privileged" limit="<%= cpu_shares %>" action="none"/>
  </rctl>
  <rctl name="zone.max-lwps">
    <rctl-value priv="privileged" limit="<%= lightweight_processes %>" action="deny"/>
  </rctl>
  <rctl name="zone.cpu-cap">
    <rctl-value priv="privileged" limit="<%= cpu_cap %>" action="deny"/>
  </rctl>
  <rctl name="zone.max-swap">
    <rctl-value priv="privileged" limit="<%= swap_in_bytes %>" action="deny"/>
  </rctl>
  <rctl name="zone.max-locked-memory">
    <rctl-value priv="privileged" limit="<%= ram_in_bytes %>" action="deny"/>
  </rctl>
  <rctl name="zone.zfs-io-priority">
    <rctl-value priv="privileged" limit="<%= zfs_io_priority %>" action="none"/>
  </rctl>
  <mcap physcap="<%= ram_in_bytes %>"/>

  <% if (public_ip) { %>
    <network physical="<%= public_interface %>"/>
  <% } %>

  <% if (private_ip) { %>
    <network physical="<%= private_interface %>"/>
  <% } %>
</zone>
