<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE zone PUBLIC "-//Sun Microsystems Inc//DTD Zones//EN" "file:///usr/share/lib/xml/dtd/zonecfg.dtd.1">

<zone name="<%= zonename %>" zonepath="<%= zpool_path %>/<%= zonename %>" autoboot="true" scheduling-class="FSS" limitpriv="default,dtrace_proc,dtrace_user" ip-type="exclusive">

  <inherited-pkg-dir directory="/lib"/>
  <inherited-pkg-dir directory="/platform"/>
  <inherited-pkg-dir directory="/sbin"/>
  <inherited-pkg-dir directory="/usr"/>

  <rctl name="zone.cpu-shares">
    <rctl-value priv="privileged" limit="<%= cpu_shares %>" action="none"/>
  </rctl>
  <rctl name="zone.max-lwps">
    <rctl-value priv="privileged" limit="<%= lightweight_processes %>" action="deny"/>
  </rctl>
  <rctl name="zone.cpu-cap">
    <rctl-value priv="privileged" limit="<%= cpu_cap %>" action="deny"/>
  </rctl>
  <rctl name="zone.max-swap">
    <rctl-value priv="privileged" limit="<%= swap_in_bytes %>" action="deny"/>
  </rctl>
  <rctl name="zone.max-locked-memory">
    <rctl-value priv="privileged" limit="<%= ram_in_bytes %>" action="deny"/>
  </rctl>
  <mcap physcap="<%= ram_in_bytes %>"/>

<% if (!public_ip) { %>
  <network physical="<%= zonename %>2"/>

  <% if (!additional_private_ips.length) { %>
    <% for (var i = 0; i < additional_private_ips.length; i++) { %>
      <network address="<%= additional_private_ips[i] %>" physical="<%= private_interface_name %>"/>
    <% } %>
  <% } %>
<% } else { %>
  <network address="<%= public_ip %>" physical="<%= public_interface_name %>"/>

  <% if (additional_public_ips.length) { %>
    <% for (var i = 0; i < additional_public_ips.length; i++) { %>
      <network address="<%= additional_public_ips[i] %>" physical="<%= public_interface_name %>"/>
    <% } %>
  <% } %>

  <network address="<%= private_ip %>" physical="<%= private_interface_name %>"/>

  <% if (additional_private_ips.length) { %>
    <% for (var i = 0; i < additional_private_ips.length; i++) { %>
      <network address="<%= additional_private_ips[i] %>" physical="<%= private_interface_name %>"/>
    <% } %>
  <% } %>
<% } %>

</zone>
