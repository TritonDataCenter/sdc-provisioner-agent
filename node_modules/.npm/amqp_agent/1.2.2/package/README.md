NAME
----

AMQPAgent - A library for quickly creating Node AMQP agents.

SYNOPSIS
--------

AMQPAgent = require('./agent').AMQPAgent;
sys = require('sys');

function MyAgent(config) {
  var self = this;
  // AMQP credentials
  this.config = config = config || { amqp: {} };

  // have the agent look up the AMQP ervice via mDNS
  this.config.mdns = 'amqp-broker';

  // Manually set the machine name this agent will reply to.
  this.config.hostname = 'mastershake';

  // String that identifies this class of agent, it. It gets used
  // in the routing keys.
  config.resource = 'shazbot';

  AMQPAgent.call(this, config);

  // add callback for 'command' events
  this.addListener('command', function (command, msg) {
    if (msg.name == 'handbanana') {
      self.ackSuccess(msg.id, { 'says': 'Tonight... you.' });
    }
    else if (msg.name == 'carl') {
      self.ackError(msg.id, { 'says': 'Bad dog!!' });
    }
    else {
      self.ackSuccess(msg.id, { 'says': 'Where you at, dawg?' });
    }
  });

  this.registerCommand("testCommand");
}

sys.inherits(MyAgent, AMQPAgent);

var agent = new MyAgent();
agent.connect(function () {
  agent.setupQueue(function () {
    sys.puts("Connecteted and waiting...");                                                                             });
});


DESCRIPTION
-----------

The AMQPAgent class contains a lot of boiler plate that is required for a
robust agent does not need to be reinvented in every AMQP agent. Things like
doing mDNS lookups, reconnection, binding exchanges and queues, receiving and
responding to messages etc.

At the moment, it is up to the end user to handle configuration files

AUTHOR
------

Orlando Vazque <orlando@joyent.com>
